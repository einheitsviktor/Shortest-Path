#ifndef VISUALIZER_H
#define VISUALIZER_H

#include <QMainWindow>
#include <QSignalMapper>
#include <QKeyEvent>

#include "grid.h"

constexpr int HEIGHT = 20;
constexpr int WIDTH = 40;
const QString EMPTY = "background-color: rgb(248, 248, 248);";
const QString OBSTACLE = "background-color: rgb(0, 0, 75);";
const QString PATH = "background-color: rgb(0, 190, 255);";
const QString VISITED = "background-color: rgb(100,150,255);";
const QString START = "background-color: rgb(0, 255, 0);";
const QString GOAL = "background-color: red;";

enum class Algorithm { breadthFirst, dijkstra, astar };

QT_BEGIN_NAMESPACE
namespace Ui { class Visualizer; }
QT_END_NAMESPACE

class Visualizer : public QMainWindow {
    Q_OBJECT

public:
    Visualizer(QWidget *parent = nullptr);
    ~Visualizer();

    static QVector<QVector<Tile*>> floor;
    static void setTile(Coordinates id, State state);
    static Coordinates startCoordinates;
    static Coordinates goalCoordinates;

 private slots:
    void handleObstacleClick(int index);

    void on_Reset_clicked();
    void on_Clear_clicked();
    void on_Search_clicked();

    void on_UpO_clicked();
    void on_LeftO_clicked();
    void on_DownO_clicked();
    void on_RightO_clicked();
    void on_UpD_clicked();
    void on_LeftD_clicked();
    void on_DownD_clicked();
    void on_RightD_clicked();

    void on_Preset1_clicked();

    void on_BreadthSearch_toggled(bool checked);
    void on_DijkstraSearch_toggled(bool checked);
    void on_AstarSearch_toggled(bool checked);

    void on_Preset2_clicked();
    void on_Preset3_clicked();
    void on_Preset4_clicked();
    void on_Preset5_clicked();

private:
    Ui::Visualizer *ui;

    Algorithm algorithm;

    bool searchExecuted;
    void setupFloor();
    void resetFloor();
    void clearFloor();

    void updateStart(Coordinates id);
    void updateGoal(Coordinates id);

    void keyPressEvent(QKeyEvent* event) override;

    // HELPER
    void printObstacles();
    void printPreset(const QVector<QVector<int>>& preset);

    // Preset obstacles
    const QVector<QVector<int>> preset1 = {
        {0,30},{0,31},{0,32},{1,30},{1,31},{1,32},{2,30},{2,31},{2,32},{3,3},{3,4},{3,5},{3,6},{3,7},{3,30},
        {3,31},{3,32},{4,3},{4,4},{4,5},{4,6},{4,7},{4,30},{4,31},{4,32},{5,3},{5,4},{5,5},{5,6},{5,7},{5,30},
        {5,31},{5,32},{6,3},{6,4},{6,5},{6,6},{6,7},{6,17},{6,18},{6,19},{6,20},{6,21},{6,30},{6,31},{6,32},
        {6,33},{6,34},{6,35},{7,3},{7,4},{7,5},{7,6},{7,7},{7,17},{7,18},{7,19},{7,20},{7,21},{7,30},{7,31},
        {7,32},{7,33},{7,34},{7,35},{8,3},{8,4},{8,5},{8,6},{8,7},{8,17},{8,18},{8,19},{8,20},{8,21},{8,30},{8,31},
        {8,32},{8,33},{8,34},{8,35},{9,3},{9,4},{9,5},{9,6},{9,7},{9,17},{9,18},{9,19},{9,20},{9,21},{10,3},{10,4},
        {10,5},{10,6},{10,7},{10,17},{10,18},{10,19},{10,20},{10,21},{11,3},{11,4},{11,5},{11,6},{11,7},{11,17},{11,18},
        {11,19},{11,20},{11,21},{12,3},{12,4},{12,5},{12,6},{12,7},{12,17},{12,18},{12,19},{12,20},{12,21},{13,3},
        {13,4},{13,5},{13,6},{13,7},{13,17},{13,18},{13,19},{13,20},{13,21},{14,3},{14,4},{14,5},{14,6},{14,7},{14,17},{14,18},
        {14,19},{14,20},{14,21},{15,3},{15,4},{15,5},{15,6},{15,7},{15,17},{15,18},{15,19},{15,20},{15,21},{16,3},{16,4},{16,5},
        {16,6},{16,7},{16,17},{16,18},{16,19},{16,20},{16,21},{17,17},{17,18},{17,19},{17,20},{17,21},{18,17},{18,18},{18,19},
        {18,20},{18,21},{19,17},{19,18},{19,19},{19,20},{19,21}
    };
    const QVector<QVector<int>> preset2 = {
        {0,1}, {0,3}, {0,5}, {0,9}, {0,13}, {0,15}, {0,17}, {0,21}, {0,23}, {0,33}, {1,1}, {1,3}, {1,5}, {1,7},
        {1,9}, {1,11}, {1,13}, {1,15}, {1,17}, {1,21}, {1,23}, {1,25}, {1,26}, {1,27}, {1,28}, {1,29}, {1,30},
        {1,31}, {1,33}, {1,35}, {1,37}, {1,39}, {2,1}, {2,3}, {2,5}, {2,7}, {2,9}, {2,11}, {2,13}, {2,15}, {2,17},
        {2,19}, {2,21}, {2,23}, {2,27}, {2,29}, {2,33}, {2,35}, {2,37}, {2,39}, {3,1}, {3,3}, {3,7}, {3,11}, {3,19},
        {3,23}, {3,25}, {3,26}, {3,27}, {3,29}, {3,33}, {3,35}, {3,37}, {3,39}, {4,1}, {4,3}, {4,5}, {4,6}, {4,7},
        {4,8}, {4,9}, {4,10}, {4,11}, {4,12}, {4,13}, {4,14}, {4,15}, {4,16}, {4,17}, {4,18}, {4,19}, {4,20}, {4,23},
        {4,27}, {4,29}, {4,30}, {4,31}, {4,33}, {4,35}, {4,36}, {4,37}, {4,38}, {4,39}, {5,1}, {5,3}, {5,5}, {5,7},
        {5,17}, {5,19}, {5,27}, {5,29}, {5,31}, {5,33}, {5,37}, {5,39}, {6,1}, {6,5}, {6,7}, {6,8}, {6,9}, {6,10},
        {6,11}, {6,12}, {6,13}, {6,14}, {6,15}, {6,17}, {6,19}, {6,20}, {6,21}, {6,22}, {6,23}, {6,25}, {6,27}, {6,29},
        {6,31}, {6,33}, {6,35}, {6,37}, {6,39}, {7,1}, {7,3}, {7,5}, {7,7}, {7,10}, {7,12}, {7,15}, {7,27}, {7,33},
        {7,35}, {7,37}, {8,1}, {8,3}, {8,5}, {8,10}, {8,12}, {8,17}, {8,20}, {8,21}, {8,22}, {8,23}, {8,24}, {8,25},
        {8,27}, {8,28}, {8,29}, {8,30}, {8,31}, {8,32}, {8,33}, {8,35}, {8,36}, {8,37}, {8,38}, {9,3}, {9,5}, {9,7},
        {9,8}, {9,14}, {9,15}, {9,16}, {9,17}, {9,18}, {9,25}, {9,27}, {9,29}, {9,31}, {9,33}, {9,37}, {10,1}, {10,3},
        {10,5}, {10,7}, {10,10}, {10,12}, {10,15}, {10,20}, {10,22}, {10,23}, {10,24}, {10,25}, {10,27}, {10,29},
        {10,31}, {10,33}, {11,1}, {11,3}, {11,5}, {11,7}, {11,10}, {11,12}, {11,17}, {11,20}, {11,25}, {11,27}, {11,33},
        {11,35}, {11,37}, {11,38}, {11,39}, {12,1}, {12,3}, {12,5}, {12,7}, {12,9}, {12,10}, {12,11}, {12,12}, {12,13},
        {12,15}, {12,16}, {12,17}, {12,19}, {12,20}, {12,21}, {12,22}, {12,23}, {12,25}, {12,27}, {12,29}, {12,30},
        {12,31}, {12,33}, {12,35}, {13,1}, {13,3}, {13,5}, {13,7}, {13,11}, {13,13}, {13,15}, {13,17}, {13,19}, {13,23},
        {13,25}, {13,27}, {13,29}, {13,31}, {13,33}, {13,35}, {14,1}, {14,3}, {14,5}, {14,7}, {14,9}, {14,11}, {14,13},
        {14,15}, {14,17}, {14,19}, {14,21}, {14,23}, {14,25}, {14,27}, {14,29}, {14,31}, {14,33}, {14,35}, {14,37},
        {14,38}, {15,1}, {15,3}, {15,5}, {15,7}, {15,9}, {15,13}, {15,15}, {15,21}, {15,23}, {15,25}, {15,27}, {15,29},
        {15,31}, {15,33}, {15,35}, {15,38}, {16,1}, {16,3}, {16,7}, {16,9}, {16,11}, {16,13}, {16,15}, {16,17}, {16,19},
        {16,21}, {16,23}, {16,25}, {16,27}, {16,29}, {16,31}, {16,33}, {16,35}, {16,38}, {17,1}, {17,3}, {17,5}, {17,7},
        {17,9}, {17,11}, {17,15}, {17,17}, {17,19}, {17,21}, {17,25}, {17,27}, {17,29}, {17,31}, {17,33}, {17,35}, {17,38},
        {18,1}, {18,3}, {18,5}, {18,7}, {18,9}, {18,11}, {18,13}, {18,15}, {18,17}, {18,19}, {18,21}, {18,23}, {18,25},
        {18,27}, {18,29}, {18,35}, {18,37}, {18,38}, {18,39}, {19,1}, {19,3}, {19,5}, {19,7}, {19,9}, {19,11}, {19,13},
        {19,15}, {19,17}, {19,19}, {19,21}, {19,23}, {19,25}, {19,29}, {19,33}, {19,35}, {19,39},
    };
    const QVector<QVector<int>> preset3 = {
        {0,0}, {0,1}, {1,1}, {0,8}, {0,20}, {0,29}, {1,0}, {1,8}, {1,17}, {1,20}, {1,22}, {1,23}, {1,29}, {1,30}, {1,31}, {1,34},
        {1,35}, {1,36}, {1,37}, {1,38}, {1,39}, {2,1}, {2,2}, {2,8}, {2,10}, {2,16}, {2,17}, {2,18}, {2,19}, {2,20}, {2,22},
        {2,25}, {2,31}, {2,34}, {2,36}, {3,7}, {3,9}, {3,24}, {3,25}, {3,27}, {3,28}, {3,34}, {4,0}, {4,1}, {4,5}, {4,7},
        {4,10}, {4,11}, {4,12}, {4,15}, {4,23}, {4,25}, {4,27}, {4,34}, {4,36}, {5,0}, {5,4}, {5,8}, {5,15}, {5,25}, {5,27},
        {5,29}, {5,30}, {5,34}, {5,35}, {5,36}, {5,37}, {5,38}, {6,3}, {6,7}, {6,8}, {6,9}, {6,10}, {6,15}, {6,17}, {6,18},
        {6,19}, {6,20}, {6,21}, {6,22}, {6,25}, {6,30}, {6,38}, {7,4}, {7,17}, {7,28}, {7,30}, {8,0}, {8,1}, {8,5}, {8,12},
        {8,13}, {8,17}, {8,20}, {8,22}, {8,25}, {8,28}, {8,30}, {8,37}, {9,6}, {9,13}, {9,17}, {9,20}, {9,22}, {9,25}, {9,28},
        {9,34}, {9,37}, {10,1}, {10,10}, {10,20}, {10,22}, {10,26}, {10,28}, {10,34}, {11,1}, {11,3}, {11,4}, {11,10}, {11,14},
        {11,15}, {11,16}, {11,17}, {11,18}, {11,19}, {11,20}, {11,22}, {11,26}, {11,28}, {11,30}, {11,31}, {11,33}, {11,34},
        {12,3}, {12,4}, {12,7}, {12,10}, {12,22}, {12,26}, {12,28}, {12,34}, {12,37}, {13,1}, {13,2}, {13,3}, {13,4}, {13,8},
        {13,22}, {13,28}, {13,37}, {14,3}, {14,4}, {14,8}, {14,9}, {14,15}, {14,18}, {14,19}, {14,20}, {14,21}, {14,22}, {14,37},
        {15,3}, {15,4}, {15,13}, {15,14}, {15,15}, {15,18}, {16,0}, {16,1}, {16,18}, {16,19}, {16,20}, {16,21}, {16,22}, {16,23},
        {16,24}, {16,25}, {16,26}, {16,31}, {17,5}, {17,6}, {17,7}, {17,8}, {17,9}, {17,15}, {17,30}, {17,32}, {18,1}, {18,7},
        {18,13}, {18,15}, {18,22}, {18,24}, {18,25}, {18,26}, {18,31}, {18,38}, {19,1}, {19,2}, {19,14}, {19,15}, {19,16}, {19,22},
        {19,26}, {19,37},
    };
    const QVector<QVector<int>> preset4 = {
        {5,16}, {5,17}, {5,18}, {5,19}, {5,20}, {5,21}, {5,22}, {5,23}, {6,23}, {7,23}, {8,23},
        {9,23}, {10,23}, {11,23}, {12,23}, {13,23}, {14,23}, {15,13}, {15,14}, {15,15}, {15,16},
        {15,17}, {15,18}, {15,19}, {15,20}, {15,21}, {15,22}, {15,23}
    };
    const QVector<QVector<int>> preset5 = {
        {5,15},{5,23},{6,16},{6,22},{7,17},{7,21},{8,18}, {8,20}, {9,19}, {10,18}, {10,20}, {11,17},
        {11,21}, {12,16}, {12,22}, {13,15}, {13,23}
    };
};
#endif // VISUALIZER_H
